<html>
  <head>
    <title>WLang specification</title>
    <style>
      body {
        font-family: arial, verdana, sans-serif;
        width: 1024px; 
        margin: auto; 
        margin-top: 20px;
      }
      h2 {
        border-bottom: 1px solid black;
      }
      table {
        font-size: 12px;
        border-collapse: collapse; 
        border: 1px solid black;
      }
      table th { background: green; color: white; }
      table th, table td { padding: 4px; }
      table td { border-bottom: 1px dashed black; }
      th.signature, td.signature { width: 250px; }
      th.name, td.name { width: 150px; }
      th.definition, td.definition { width: 600px; }
    </style>
  </head>
  <body>
    <h1>WLang specification (version 0.0.7)</h1>
    <p>
WLang is a a reusable and extensible <em>code generator</em>, also known as
a <em>templating engine</em>
</p>

    <h2>Standard rulesets</h2>
    
      <h3>Imperative</h3>
      <table class="ruleset">
        <tr>
          <th class="signature">signature</th>
          <th class="name">name</th>
          <th class="definition">definition</th>
        </tr>
        
          <tr>
            <td class="signature"><tt>?{wlang/hosted}{...}{...}</tt></td>
            <td class="name">conditional</td>
            <td class="definition"><p>
<b>(third block is optional)</b> Instanciates #1, looking for an expression
in the hosting language. Evaluates it, looking for a boolean value
(according to boolean semantics of the hosting language). If true,
instanciates #2, otherwise instanciates #3 if present.
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>*{wlang/hosted}{...}{...}</tt></td>
            <td class="name">enumeration</td>
            <td class="definition"><p>
<b>(third block is optional)</b> Instanciates #1, looking for an expression
in the hosting language. Evaluates it, looking for an enumerable. Iterates
all its elements, instanciating #2 for each of them (the iterated value is
set under name x in the scope). If #3 is present, it is instanciated
between elements.
</p>
</td>
          </tr>
        
      </table>
    
      <h3>Basic</h3>
      <table class="ruleset">
        <tr>
          <th class="signature">signature</th>
          <th class="name">name</th>
          <th class="definition">definition</th>
        </tr>
        
          <tr>
            <td class="signature"><tt>!{wlang/hosted}</tt></td>
            <td class="name">execution</td>
            <td class="definition"><p>
Instanciates #1, looking for a ruby expression. Evaluates it, looking for
any object. Invokes to_s on it and returns the result as replacement value.
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>%{wlang/active-string}{...}</tt></td>
            <td class="name">modulation</td>
            <td class="definition"><p>
Instanciates #1, looking for a dialect qualified name. Instantiates #2
according to the rules defined by that dialect and returns the #2&#8217;s
instantiation as replacement value.
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>^{wlang/active-string}{...}</tt></td>
            <td class="name">encoding</td>
            <td class="definition"><p>
Instanciates #1, looking for an encoder qualified name. Instanciates #2 in
the current dialect. Encode #2&#8217;s instantiation using encoder found in
(#1)
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>${wlang/hosted}</tt></td>
            <td class="name">injection</td>
            <td class="definition"><p>
Same semantics as execution so far.
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>+{wlang/hosted}</tt></td>
            <td class="name">inclusion</td>
            <td class="definition"><p>
Same semantics as execution so far.
</p>
</td>
          </tr>
        
      </table>
    
      <h3>Buffering</h3>
      <table class="ruleset">
        <tr>
          <th class="signature">signature</th>
          <th class="name">name</th>
          <th class="definition">definition</th>
        </tr>
        
          <tr>
            <td class="signature"><tt>&lt;&lt;{wlang/uri}</tt></td>
            <td class="name">input</td>
            <td class="definition"><p>
Instanciates #1, looking for an uri. Returns the text content of the found
uri (#1).
</p>
</td>
          </tr>
        
      </table>
    
      <h3>Encoding</h3>
      <table class="ruleset">
        <tr>
          <th class="signature">signature</th>
          <th class="name">name</th>
          <th class="definition">definition</th>
        </tr>
        
          <tr>
            <td class="signature"><tt>&amp;{...}</tt></td>
            <td class="name">main-encoding</td>
            <td class="definition"><p>
<tt>^{+{@parser.current_dialect}/main-encoding}{#2}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>&amp;;{...}</tt></td>
            <td class="name">entities-encoding</td>
            <td class="definition"><p>
<tt>^{+{@parser.current_dialect}/entities-encoding}{#2}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>&amp;'{...}</tt></td>
            <td class="name">single-quoting</td>
            <td class="definition"><p>
<tt>^{+{@parser.current_dialect}/single-quoting}{#2}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>&amp;&quot;{...}</tt></td>
            <td class="name">double-quoting</td>
            <td class="definition"><p>
<tt>^{+{@parser.current_dialect}/double-quoting}{#2}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>${wlang/hosted}</tt></td>
            <td class="name">injection</td>
            <td class="definition"><p>
<tt>&amp;{+{#1}}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>'{wlang/hosted}</tt></td>
            <td class="name">single-quoted</td>
            <td class="definition"><p>
<tt>'&amp;'{+{#1}}</tt>
</p>
</td>
          </tr>
        
          <tr>
            <td class="signature"><tt>&quot;{wlang/hosted}</tt></td>
            <td class="name">double-quoted</td>
            <td class="definition"><p>
<tt>&quot;&amp;&quot;{+{#1}}</tt>
</p>
</td>
          </tr>
        
      </table>
    
  </body>
</html>
